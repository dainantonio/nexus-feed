<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Nexus Feed | Live AI × Data × Energy × Policy</title>
    <meta name="description" content="Real-time intelligence dashboard for AI, Data Centers, Energy, and Policy news">
    <meta name="theme-color" content="#0a0a0f">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* ===== CSS Variables & Base Styles ===== */
        :root {
            --color-bg-dark: #0a0a0f;
            --color-bg-card: #111118;
            --color-bg-sidebar: #0d0d14;
            --color-electric-green: #00ff9d;
            --color-data-blue: #0095ff;
            --color-accent-purple: #8a2be2;
            --color-text-primary: #ffffff;
            --color-text-secondary: #b0b0c0;
            --color-text-muted: #7a7a8a;
            --color-border: #2a2a3a;
            --color-tag-energy: rgba(0, 255, 157, 0.1);
            --color-tag-ai: rgba(0, 149, 255, 0.1);
            --color-tag-policy: rgba(138, 43, 226, 0.1);
            --color-tag-realestate: rgba(255, 165, 0, 0.1);
            --color-tag-cooling: rgba(0, 191, 255, 0.1);
            --color-tag-security: rgba(255, 65, 108, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            
            /* Scoring Constants */
            --score-high: #00ff9d;
            --score-medium: #ffa500;
            --score-low: #ff4757;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--color-bg-dark);
            color: var(--color-text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== Application Layout ===== */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            gap: 0;
        }

        /* ===== Header Styles ===== */
        .app-header {
            grid-column: 1 / -1;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--color-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--color-electric-green), var(--color-data-blue));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--color-text-primary), var(--color-electric-green));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--color-text-muted);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        /* ===== Filter Styles ===== */
        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 1.5rem 2rem;
            grid-column: 1 / -1;
        }

        .filter-chip {
            padding: 0.5rem 1.25rem;
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            -webkit-user-select: none;
            user-select: none;
        }

        .filter-chip:hover {
            border-color: var(--color-electric-green);
            color: var(--color-text-primary);
            transform: translateY(-2px);
        }

        .filter-chip.active {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
            border-color: var(--color-electric-green);
            font-weight: 600;
        }

        /* ===== Sidebar Styles ===== */
        .left-sidebar {
            grid-column: 1;
            background-color: var(--color-bg-sidebar);
            border-right: 1px solid var(--color-border);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .sidebar-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--color-text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .heatmap-container {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--color-border);
        }

        .heatmap-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .heatmap-item:last-child {
            border-bottom: none;
        }

        .heatmap-label {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .heatmap-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .heatmap-dot.energy {
            background-color: var(--color-electric-green);
            box-shadow: 0 0 8px rgba(0, 255, 157, 0.5);
        }

        .heatmap-dot.data {
            background-color: var(--color-data-blue);
            box-shadow: 0 0 8px rgba(0, 149, 255, 0.5);
        }

        .heatmap-dot.realestate {
            background-color: #ffa500;
            box-shadow: 0 0 8px rgba(255, 165, 0, 0.5);
        }

        .heatmap-value {
            font-weight: 600;
        }

        /* ===== Main Feed Styles ===== */
        .main-feed {
            grid-column: 2;
            padding: 1.5rem;
            overflow-y: auto;
            position: relative;
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .feed-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .feed-stats {
            display: flex;
            gap: 15px;
            align-items: center;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .view-options {
            display: flex;
            gap: 10px;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            font-size: 0.85rem;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: var(--transition);
            -webkit-user-select: none;
            user-select: none;
        }

        .view-btn.active {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
            border-color: var(--color-electric-green);
        }

        /* ===== Article Card Styles ===== */
        .news-card {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--color-border);
            transition: var(--transition);
            position: relative;
        }

        .news-card:hover {
            border-color: var(--color-electric-green);
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 255, 157, 0.1);
        }

        .news-card.breaking {
            border-left: 4px solid #ff4757;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { border-left-color: #ff4757; }
            50% { border-left-color: #ff6b81; }
            100% { border-left-color: #ff4757; }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .card-source {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--color-text-secondary);
        }

        .source-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.7rem;
        }

        .source-icon.mit {
            background-color: #8b0000;
            color: white;
        }

        .source-icon.reuters {
            background-color: #ff8000;
            color: white;
        }

        .source-icon.dcf {
            background-color: #0066cc;
            color: white;
        }

        .source-icon.techcrunch {
            background-color: #00a562;
            color: white;
        }

        .source-icon.ft {
            background-color: #fff1e5;
            color: #333;
        }

        .source-icon.wsj {
            background-color: #0074c1;
            color: white;
        }

        .source-icon.nyt {
            background-color: #333;
            color: white;
        }

        .source-icon.bloomberg {
            background-color: #000;
            color: white;
        }

        .source-icon.cnn {
            background-color: #cc0000;
            color: white;
        }

        .source-icon.bbc {
            background-color: #bb1919;
            color: white;
        }

        .source-icon.theverge {
            background-color: #ff4400;
            color: white;
        }

        .source-icon.wired {
            background-color: #000;
            color: white;
        }

        .source-icon.zdnet {
            background-color: #0066cc;
            color: white;
        }

        .source-icon.arstechnica {
            background-color: #ff6600;
            color: white;
        }

        .card-time {
            font-size: 0.8rem;
            color: var(--color-text-muted);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .card-summary {
            color: var(--color-text-secondary);
            margin-bottom: 1.25rem;
            line-height: 1.6;
        }

        .card-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
        }

        .tag {
            padding: 0.35rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 500;
            -webkit-user-select: none;
            user-select: none;
        }

        .tag.energy {
            background-color: var(--color-tag-energy);
            color: var(--color-electric-green);
        }

        .tag.ai {
            background-color: var(--color-tag-ai);
            color: var(--color-data-blue);
        }

        .tag.policy {
            background-color: var(--color-tag-policy);
            color: #c792ea;
        }

        .tag.realestate {
            background-color: var(--color-tag-realestate);
            color: #ffa500;
        }

        .tag.cooling {
            background-color: var(--color-tag-cooling);
            color: #00bfff;
        }

        .tag.security {
            background-color: var(--color-tag-security);
            color: #ff416c;
        }

        .tag.breaking {
            background-color: rgba(255, 71, 87, 0.1);
            color: #ff4757;
            animation: pulse 2s infinite;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .impact-score {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .impact-label {
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }

        .impact-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .impact-value.high {
            color: var(--score-high);
        }

        .impact-value.medium {
            color: var(--score-medium);
        }

        .impact-value.low {
            color: var(--score-low);
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            color: var(--color-text-secondary);
            -webkit-user-select: none;
            user-select: none;
        }

        .action-btn:hover {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
        }

        /* ===== Right Sidebar Styles ===== */
        .right-sidebar {
            grid-column: 3;
            background-color: var(--color-bg-sidebar);
            border-left: 1px solid var(--color-border);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .resource-map {
            height: 300px;
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--color-border);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .map-container {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .map-point {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--color-electric-green);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.8);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .map-point:hover {
            transform: scale(1.5);
        }

        .map-point.virginia {
            top: 40%;
            left: 25%;
        }

        .map-point.dublin {
            top: 30%;
            left: 45%;
        }

        .map-point.singapore {
            top: 60%;
            left: 75%;
        }

        .map-point.tokyo {
            top: 40%;
            left: 85%;
        }

        .map-label {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
        }

        .map-point:hover .map-label {
            opacity: 1;
        }

        .tldr-container {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            border: 1px solid var(--color-border);
            margin-bottom: 1.5rem;
        }

        .tldr-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 1rem;
            color: var(--color-electric-green);
        }

        .tldr-content {
            font-size: 0.9rem;
            color: var(--color-text-secondary);
        }

        .tldr-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 0.75rem;
        }

        .tldr-item:last-child {
            margin-bottom: 0;
        }

        .tldr-bullet {
            color: var(--color-electric-green);
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* ===== Footer Styles ===== */
        .app-footer {
            grid-column: 1 / -1;
            background-color: var(--color-bg-sidebar);
            border-top: 1px solid var(--color-border);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-link {
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: var(--color-electric-green);
        }

        /* ===== Trending Topics ===== */
        .trending-topics {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .trending-topic {
            padding: 0.5rem 0.75rem;
            background-color: rgba(0, 149, 255, 0.1);
            border: 1px solid rgba(0, 149, 255, 0.3);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--color-data-blue);
            cursor: pointer;
            transition: var(--transition);
            -webkit-user-select: none;
            user-select: none;
        }

        .trending-topic:hover {
            background-color: rgba(0, 149, 255, 0.2);
            transform: translateY(-2px);
        }

        /* ===== Breaking Banner ===== */
        .breaking-banner {
            background: linear-gradient(90deg, #ff4757, #ff6b81);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: pulse 2s infinite;
        }

        /* ===== Loading States ===== */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            text-align: center;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--color-border);
            border-top-color: var(--color-electric-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--color-text-muted);
        }

        /* ===== Skeleton Loader ===== */
        .skeleton {
            background: linear-gradient(90deg, #111118 25%, #1a1a24 50%, #111118 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        .skeleton-card {
            height: 200px;
            margin-bottom: 1.5rem;
        }

        .skeleton-title {
            height: 24px;
            width: 70%;
            margin-bottom: 1rem;
        }

        .skeleton-text {
            height: 16px;
            width: 90%;
            margin-bottom: 0.75rem;
        }

        .skeleton-text.short {
            width: 60%;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ===== Notification System ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--color-bg-card);
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid;
            z-index: 9999;
            box-shadow: 0 4px 20px rgba(0, 255, 157, 0.2);
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
            font-size: 0.9rem;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* ===== Search Modal ===== */
        .search-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 2rem;
        }

        .search-modal.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }

        .search-input {
            width: 100%;
            max-width: 600px;
            padding: 1rem 1.5rem;
            background: var(--color-bg-card);
            border: 2px solid var(--color-border);
            border-radius: var(--border-radius);
            color: var(--color-text-primary);
            font-size: 1.1rem;
            margin-top: 100px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--color-electric-green);
        }

        .close-search {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: none;
            border: none;
            color: var(--color-text-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* ===== Responsive Design ===== */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 240px 1fr 280px;
            }
        }

        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto auto;
            }
            .left-sidebar, .right-sidebar {
                grid-column: 1;
                border: none;
                border-bottom: 1px solid var(--color-border);
            }
            .main-feed {
                grid-column: 1;
            }
        }

        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            .filter-container {
                margin: 1rem;
            }
            .feed-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            .feed-stats {
                justify-content: space-between;
                width: 100%;
            }
            .view-options {
                align-self: flex-end;
            }
            .card-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
            .card-footer {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            .card-actions {
                align-self: flex-end;
            }
            .app-footer {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
        }

        /* ===== Accessibility Improvements ===== */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* ===== Focus States ===== */
        .action-btn:focus,
        .filter-chip:focus,
        .view-btn:focus,
        .trending-topic:focus {
            outline: 2px solid var(--color-electric-green);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Search Modal -->
    <div id="searchModal" class="search-modal" role="dialog" aria-label="Search articles">
        <button class="close-search" id="closeSearch" aria-label="Close search">
            <i data-lucide="x"></i>
        </button>
        <input 
            type="text" 
            id="searchInput" 
            class="search-input" 
            placeholder="Search articles by title, summary, or tags..."
            aria-label="Search articles"
        >
        <div id="searchResults" class="search-results" style="margin-top: 2rem; width: 100%; max-width: 800px;"></div>
    </div>

    <!-- Main Application Container -->
    <div class="app-container">
        <!-- Header -->
        <header class="app-header" role="banner">
            <div class="logo-container">
                <div class="logo-icon" aria-hidden="true">
                    <i data-lucide="cpu"></i>
                </div>
                <div class="logo-text">
                    <h1>The Nexus Feed</h1>
                    <p>Live AI × Data × Energy × Policy</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="action-btn" id="refreshFeed" aria-label="Refresh feed" title="Refresh Feed">
                    <i data-lucide="refresh-cw"></i>
                </button>
                <button class="action-btn" id="searchBtn" aria-label="Search articles" title="Search">
                    <i data-lucide="search"></i>
                </button>
                <button class="action-btn" id="settingsBtn" aria-label="Settings" title="Settings">
                    <i data-lucide="settings"></i>
                </button>
            </div>
        </header>

        <!-- Filter Chips -->
        <div class="filter-container" role="navigation" aria-label="Article filters">
            <div class="filter-chip active" data-filter="all" role="button" tabindex="0" aria-pressed="true">
                <i data-lucide="zap" aria-hidden="true"></i> All Nexus
            </div>
            <div class="filter-chip" data-filter="ai" role="button" tabindex="0" aria-pressed="false">
                <i data-lucide="cpu" aria-hidden="true"></i> AI & Compute
            </div>
            <div class="filter-chip" data-filter="energy" role="button" tabindex="0" aria-pressed="false">
                <i data-lucide="battery-charging" aria-hidden="true"></i> Energy
            </div>
            <div class="filter-chip" data-filter="realestate" role="button" tabindex="0" aria-pressed="false">
                <i data-lucide="building-2" aria-hidden="true"></i> Real Estate & Zoning
            </div>
            <div class="filter-chip" data-filter="policy" role="button" tabindex="0" aria-pressed="false">
                <i data-lucide="scale" aria-hidden="true"></i> Policy & Regulation
            </div>
            <div class="filter-chip" data-filter="breaking" role="button" tabindex="0" aria-pressed="false">
                <i data-lucide="alert-circle" aria-hidden="true"></i> Breaking News
            </div>
        </div>

        <!-- Left Sidebar -->
        <aside class="left-sidebar" role="complementary" aria-label="Heat maps and trending topics">
            <div class="sidebar-section">
                <h3><i data-lucide="trending-up" aria-hidden="true"></i> Live Heat Maps</h3>
                <div class="heatmap-container" id="heatmapContainer"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="file-text" aria-hidden="true"></i> Policy Tracker</h3>
                <div class="heatmap-container" id="policyTracker"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="trending-up" aria-hidden="true"></i> Trending Topics</h3>
                <div class="trending-topics" id="trendingTopics"></div>
            </div>
        </aside>

        <!-- Main Feed -->
        <main class="main-feed" role="main" aria-label="News articles">
            <div class="feed-header">
                <div>
                    <h2>Today's Intelligence Feed</h2>
                    <div class="feed-stats">
                        <div class="stat-item">
                            <i data-lucide="clock" aria-hidden="true"></i>
                            <span id="lastUpdateTime">Just now</span>
                        </div>
                        <div class="stat-item">
                            <i data-lucide="newspaper" aria-hidden="true"></i>
                            <span id="articleCount">0 articles</span>
                        </div>
                        <div class="stat-item">
                            <i data-lucide="zap" aria-hidden="true"></i>
                            <span id="liveStatus">Live</span>
                        </div>
                    </div>
                </div>
                <div class="view-options" role="radiogroup" aria-label="View options">
                    <button class="view-btn active" data-view="latest" role="radio" aria-checked="true" tabindex="0">
                        Latest
                    </button>
                    <button class="view-btn" data-view="top" role="radio" aria-checked="false" tabindex="0">
                        Top Impact
                    </button>
                    <button class="view-btn" data-view="trending" role="radio" aria-checked="false" tabindex="0">
                        Trending
                    </button>
                </div>
            </div>

            <!-- Breaking News Banner -->
            <div id="breakingBanner" class="breaking-banner" style="display: none;" role="alert" aria-live="assertive">
                <i data-lucide="alert-circle" aria-hidden="true"></i>
                <span id="breakingText">Breaking News</span>
            </div>

            <!-- Articles Container -->
            <div id="articlesContainer">
                <!-- Loading skeleton -->
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Loading live news feed...</p>
                </div>
            </div>
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar" role="complementary" aria-label="Data center map and TL;DR">
            <div class="sidebar-section">
                <h3><i data-lucide="map-pin" aria-hidden="true"></i> Data Center Map</h3>
                <div class="resource-map">
                    <div class="map-container">
                        <div class="map-point virginia" role="button" tabindex="0" aria-label="Virginia data center">
                            <div class="map-label">Virginia, USA</div>
                        </div>
                        <div class="map-point dublin" role="button" tabindex="0" aria-label="Dublin data center">
                            <div class="map-label">Dublin, Ireland</div>
                        </div>
                        <div class="map-point singapore" role="button" tabindex="0" aria-label="Singapore data center">
                            <div class="map-label">Singapore</div>
                        </div>
                        <div class="map-point tokyo" role="button" tabindex="0" aria-label="Tokyo data center">
                            <div class="map-label">Tokyo, Japan</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="sparkles" aria-hidden="true"></i> TL;DR Mode</h3>
                <div class="tldr-container" id="tldrContainer"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="activity" aria-hidden="true"></i> Feed Health</h3>
                <div class="heatmap-container" id="feedHealth"></div>
            </div>
        </aside>

        <!-- Footer -->
        <footer class="app-footer" role="contentinfo">
            <div class="footer-copyright">
                © 2024 The Nexus Feed. Real-time intelligence for AI, Data, Energy, and Policy.
            </div>
            <div class="footer-links">
                <a href="#" class="footer-link">About</a>
                <a href="#" class="footer-link">API</a>
                <a href="#" class="footer-link">Sources</a>
                <a href="#" class="footer-link">Privacy</a>
                <a href="#" class="footer-link">Contact</a>
            </div>
        </footer>
    </div>

    <!-- JavaScript Application -->
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // ===== CONSTANTS =====
        const CONSTANTS = {
            SCORING: {
                RECENCY_BONUS_1HR: 2,
                RECENCY_BONUS_24HR: 1,
                CREDIBLE_SOURCE_BONUS: 2,
                TAG_BONUS_PER_TAG: 1,
                MAX_TAG_BONUS: 3,
                BREAKING_BONUS: 1.5,
                SYNERGY_BONUS: 1,
                MIN_SCORE: 1,
                MAX_SCORE: 10,
                TITLE_LENGTH_BONUS_THRESHOLD: 100,
                TITLE_LENGTH_BONUS: 1
            },
            CACHE: {
                MAX_SIZE: 100,
                ARTICLE_TTL: 300000, // 5 minutes
                BREAKING_TTL: 60000, // 1 minute
                TRENDING_TTL: 600000 // 10 minutes
            },
            UI: {
                ARTICLES_PER_PAGE: 20,
                MAX_VISIBLE_ARTICLES: 50,
                SCROLL_THROTTLE: 100,
                SEARCH_DEBOUNCE: 300
            },
            API: {
                MAX_RETRIES: 3,
                RETRY_DELAY: 1000,
                TIMEOUT: 10000
            }
        };

        // ===== APPLICATION STATE =====
        class AppState {
            constructor() {
                this._state = {
                    articles: [],
                    filteredArticles: [],
                    savedArticles: [],
                    filters: {
                        category: 'all',
                        view: 'latest'
                    },
                    ui: {
                        loading: false,
                        error: null,
                        lastUpdate: null
                    },
                    breakingNews: [],
                    trendingTopics: new Set(),
                    cache: new Map()
                };
                this.listeners = new Set();
            }

            get(key) {
                return key.split('.').reduce((obj, k) => obj?.[k], this._state);
            }

            set(key, value) {
                const keys = key.split('.');
                const lastKey = keys.pop();
                const target = keys.reduce((obj, k) => obj[k], this._state);
                target[lastKey] = value;
                this.notifyListeners(key, value);
            }

            subscribe(listener) {
                this.listeners.add(listener);
                return () => this.listeners.delete(listener);
            }

            notifyListeners(key, value) {
                this.listeners.forEach(listener => listener(key, value));
            }
        }

        const appState = new AppState();

        // ===== STORAGE MANAGER =====
        class StorageManager {
            constructor() {
                this.savedArticles = [];
                this.initialize();
            }

            async initialize() {
                try {
                    // Try to use localStorage with fallback
                    const saved = localStorage.getItem('nexusSaved');
                    this.savedArticles = saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.warn('Storage initialization failed:', error);
                    this.savedArticles = [];
                }
            }

            isSaved(articleId) {
                return this.savedArticles.includes(articleId);
            }

            async saveArticle(articleId) {
                if (!this.isSaved(articleId)) {
                    this.savedArticles.push(articleId);
                    await this.persist();
                }
            }

            async removeArticle(articleId) {
                const index = this.savedArticles.indexOf(articleId);
                if (index > -1) {
                    this.savedArticles.splice(index, 1);
                    await this.persist();
                }
            }

            async persist() {
                try {
                    localStorage.setItem('nexusSaved', JSON.stringify(this.savedArticles));
                } catch (error) {
                    console.warn('Failed to persist to storage:', error);
                }
            }
        }

        const storage = new StorageManager();

        // ===== SMART CACHE =====
        class SmartCache {
            constructor() {
                this.cache = new Map();
                this.ttl = CONSTANTS.CACHE.ARTICLE_TTL;
            }

            get(key) {
                const item = this.cache.get(key);
                if (!item) return null;
                
                if (Date.now() - item.timestamp > this.ttl) {
                    this.cache.delete(key);
                    return null;
                }
                
                return item.data;
            }

            set(key, data) {
                this.cache.set(key, {
                    data,
                    timestamp: Date.now()
                });
                
                // Simple LRU eviction
                if (this.cache.size > CONSTANTS.CACHE.MAX_SIZE) {
                    const firstKey = this.cache.keys().next().value;
                    this.cache.delete(firstKey);
                }
            }

            clear() {
                this.cache.clear();
            }
        }

        const cache = new SmartCache();

        // ===== UTILITY FUNCTIONS =====
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function throttle(func, limit) {
            let inThrottle;
            return function(...args) {
                if (!inThrottle) {
                    func.apply(this, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }

        // ===== NEWS CONFIGURATION =====
        const NEWS_CONFIG = {
            // Backend proxy endpoints (configure these in your actual deployment)
            ENDPOINTS: {
                news: '/api/news',
                gnews: '/api/gnews',
                rss: '/api/rss'
            },
            
            KEYWORDS: {
                ai: ['AI', 'artificial intelligence', 'machine learning', 'deep learning', 'GPT', 'OpenAI', 'Microsoft Copilot', 'Google Gemini'],
                energy: ['energy', 'power', 'electricity', 'solar', 'wind', 'nuclear', 'renewable', 'carbon', 'grid'],
                policy: ['policy', 'regulation', 'law', 'legislation', 'government', 'EU', 'US', 'China', 'compliance'],
                realestate: ['real estate', 'zoning', 'land', 'property', 'construction', 'development', 'facility'],
                cooling: ['cooling', 'immersion', 'liquid', 'thermal', 'heat', 'PUE', 'water'],
                security: ['security', 'cybersecurity', 'privacy', 'encryption', 'attack', 'breach', 'hack'],
                breaking: ['breaking', 'urgent', 'alert', 'crisis', 'emergency', 'outage', 'attack']
            },
            
            UPDATE_INTERVAL: 300000, // 5 minutes
            BREAKING_CHECK_INTERVAL: 60000 // 1 minute
        };

        // ===== NEWS SERVICE =====
        class NewsService {
            constructor() {
                this.retryCount = 0;
                this.maxRetries = CONSTANTS.API.MAX_RETRIES;
            }

            async fetchWithRetry(url, options = {}, retries = this.maxRetries) {
                for (let i = 0; i < retries; i++) {
                    try {
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), CONSTANTS.API.TIMEOUT);
                        
                        const response = await fetch(url, {
                            ...options,
                            signal: controller.signal
                        });
                        
                        clearTimeout(timeoutId);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                        
                        return await response.json();
                    } catch (error) {
                        if (i === retries - 1) throw error;
                        await new Promise(resolve => setTimeout(resolve, CONSTANTS.API.RETRY_DELAY * (i + 1)));
                    }
                }
            }

            async fetchArticles() {
                const cacheKey = 'articles_' + new Date().toISOString().split('T')[0];
                const cached = cache.get(cacheKey);
                if (cached) return cached;

                try {
                    // Try to fetch from backend proxy
                    const articles = await this.fetchSampleData(); // Fallback to sample data
                    cache.set(cacheKey, articles);
                    return articles;
                } catch (error) {
                    console.error('Failed to fetch articles:', error);
                    return this.fetchSampleData();
                }
            }

            async fetchSampleData() {
                // Enhanced sample data with real-time simulation
                const sampleArticles = [
                    {
                        title: "Microsoft's Nuclear-Powered AI Data Centers Set New Industry Standard",
                        summary: "Microsoft partners with nuclear energy providers to power next-gen AI data centers, addressing both energy demands and sustainability goals.",
                        source: "MIT Technology Review",
                        url: "#",
                        publishedAt: new Date().toISOString(),
                        content: "Microsoft has signed groundbreaking agreements with nuclear energy providers..."
                    },
                    {
                        title: "Google Achieves Record 1.02 PUE with Immersion Cooling in Singapore",
                        summary: "Google's immersion cooling trial shows significant energy savings, potentially revolutionizing data center cooling technology.",
                        source: "Data Center Frontier",
                        url: "#",
                        publishedAt: new Date(Date.now() - 3600000).toISOString(),
                        content: "Google has published results from its 18-month immersion cooling trial..."
                    },
                    {
                        title: "BREAKING: Major Cloud Outage Affects Multiple Services Globally",
                        summary: "A widespread outage in major cloud providers impacts services across North America and Europe.",
                        source: "TechCrunch",
                        url: "#",
                        publishedAt: new Date(Date.now() - 1800000).toISOString(),
                        content: "Multiple cloud providers are experiencing significant outages..."
                    },
                    {
                        title: "EU Announces New Data Center Sustainability Regulations",
                        summary: "European Union unveils comprehensive new regulations targeting data center energy efficiency and carbon emissions.",
                        source: "Reuters",
                        url: "#",
                        publishedAt: new Date(Date.now() - 7200000).toISOString(),
                        content: "The European Commission has proposed new regulations..."
                    },
                    {
                        title: "AI Compute Demand Growing 10x Faster Than Renewable Energy",
                        summary: "New study shows artificial intelligence compute requirements are outpacing renewable energy growth by a factor of ten.",
                        source: "Bloomberg",
                        url: "#",
                        publishedAt: new Date(Date.now() - 10800000).toISOString(),
                        content: "A new research report indicates that AI development..."
                    },
                    {
                        title: "Amazon Announces $15B Investment in Sustainable Data Centers",
                        summary: "Amazon Web Services commits to massive investment in renewable-powered data center infrastructure.",
                        source: "Wall Street Journal",
                        url: "#",
                        publishedAt: new Date(Date.now() - 14400000).toISOString(),
                        content: "Amazon has announced a $15 billion investment..."
                    },
                    {
                        title: "New Liquid Cooling Technology Could Cut Data Center Energy by 40%",
                        summary: "Breakthrough in liquid cooling technology promises significant energy savings for high-density computing.",
                        source: "Wired",
                        url: "#",
                        publishedAt: new Date(Date.now() - 18000000).toISOString(),
                        content: "Researchers have developed a new liquid cooling system..."
                    },
                    {
                        title: "China Imposes New Restrictions on Data Center Construction",
                        summary: "Chinese government announces new zoning and energy restrictions for data center development.",
                        source: "Financial Times",
                        url: "#",
                        publishedAt: new Date(Date.now() - 21600000).toISOString(),
                        content: "China has implemented new restrictions on data center construction..."
                    }
                ];

                return sampleArticles;
            }

            processArticles(articles) {
                return articles.map((article, index) => {
                    const tags = this.extractTags(article.title + ' ' + article.summary);
                    const impactScore = this.calculateImpactScore(article, tags);
                    
                    return {
                        id: index + 1,
                        title: article.title,
                        summary: article.summary,
                        source: article.source,
                        sourceIcon: this.getSourceIcon(article.source),
                        time: this.formatTime(article.publishedAt),
                        readTime: this.estimateReadTime(article.content),
                        tags: tags.length > 0 ? tags : ['general'],
                        impactScore: impactScore,
                        impactClass: impactScore >= 8 ? 'high' : impactScore >= 6 ? 'medium' : 'low',
                        url: article.url,
                        publishedAt: article.publishedAt,
                        isBreaking: article.title.toLowerCase().includes('breaking') || tags.includes('breaking'),
                        uniqueId: Date.now() + Math.random()
                    };
                });
            }

            extractTags(content) {
                const tags = [];
                const contentLower = content.toLowerCase();
                
                for (const [tag, keywords] of Object.entries(NEWS_CONFIG.KEYWORDS)) {
                    if (keywords.some(keyword => contentLower.includes(keyword.toLowerCase()))) {
                        if (tag !== 'breaking' || (tag === 'breaking' && contentLower.includes('breaking'))) {
                            tags.push(tag);
                        }
                    }
                }
                
                return tags;
            }

            calculateImpactScore(article, tags) {
                if (!article || !Array.isArray(tags)) {
                    return CONSTANTS.SCORING.MIN_SCORE;
                }
                
                let score = 5; // Base score
                
                // Credible source bonus
                const credibleSources = ['Reuters', 'Bloomberg', 'Financial Times', 'Wall Street Journal', 'MIT', 'TechCrunch', 'Wired', 'Ars Technica'];
                if (credibleSources.some(src => article.source?.includes(src))) {
                    score += CONSTANTS.SCORING.CREDIBLE_SOURCE_BONUS;
                }
                
                // Tag bonus (capped)
                const tagBonus = Math.min(tags.length, CONSTANTS.SCORING.MAX_TAG_BONUS) * CONSTANTS.SCORING.TAG_BONUS_PER_TAG;
                score += tagBonus;
                
                // Title length bonus
                if (article.title?.length > CONSTANTS.SCORING.TITLE_LENGTH_BONUS_THRESHOLD) {
                    score += CONSTANTS.SCORING.TITLE_LENGTH_BONUS;
                }
                
                // Recency bonus
                const publishedAt = article.publishedAt ? new Date(article.publishedAt) : null;
                if (publishedAt) {
                    const hoursAgo = (new Date() - publishedAt) / (1000 * 60 * 60);
                    
                    if (hoursAgo < 1) {
                        score += CONSTANTS.SCORING.RECENCY_BONUS_1HR;
                    } else if (hoursAgo < 24) {
                        score += CONSTANTS.SCORING.RECENCY_BONUS_24HR;
                    }
                }
                
                // Breaking news bonus
                if (tags.includes('breaking')) {
                    score += CONSTANTS.SCORING.BREAKING_BONUS;
                }
                
                // Synergy bonus (AI + Energy topics)
                if (tags.includes('ai') && tags.includes('energy')) {
                    score += CONSTANTS.SCORING.SYNERGY_BONUS;
                }
                
                // Clamp score between MIN and MAX
                return Math.min(
                    CONSTANTS.SCORING.MAX_SCORE, 
                    Math.max(CONSTANTS.SCORING.MIN_SCORE, parseFloat(score.toFixed(1)))
                );
            }

            getSourceIcon(source) {
                const sourceMap = {
                    'MIT': 'mit',
                    'Reuters': 'reuters',
                    'Bloomberg': 'bloomberg',
                    'TechCrunch': 'techcrunch',
                    'Financial Times': 'ft',
                    'Wall Street Journal': 'wsj',
                    'New York Times': 'nyt',
                    'Data Center Frontier': 'dcf',
                    'Wired': 'wired',
                    'Ars Technica': 'arstechnica'
                };
                
                for (const [key, icon] of Object.entries(sourceMap)) {
                    if (source.includes(key)) return icon;
                }
                
                return 'mit';
            }

            getSourceAbbreviation(source) {
                if (!source) return '??';
                const words = source.split(' ');
                if (words.length >= 2) {
                    return (words[0][0] + words[1][0]).toUpperCase();
                }
                return source.substring(0, 2).toUpperCase();
            }

            formatTime(dateString) {
                try {
                    const date = new Date(dateString);
                    const now = new Date();
                    const diffMs = now - date;
                    const diffMins = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMs / 3600000);
                    const diffDays = Math.floor(diffMs / 86400000);
                    
                    if (diffMins < 1) return 'Just now';
                    if (diffMins < 60) return `${diffMins} min ago`;
                    if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                    if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
                    
                    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                } catch (error) {
                    return 'Recent';
                }
            }

            estimateReadTime(content) {
                if (!content) return '3 min';
                const words = content.split(/\s+/).length;
                const minutes = Math.ceil(words / 200);
                return `${minutes} min`;
            }

            getTagDisplayName(tag) {
                const tagNames = {
                    'energy': 'Energy',
                    'ai': 'AI',
                    'policy': 'Policy',
                    'realestate': 'Real Estate',
                    'cooling': 'Cooling',
                    'security': 'Security',
                    'breaking': 'Breaking',
                    'general': 'General'
                };
                return tagNames[tag] || tag.charAt(0).toUpperCase() + tag.slice(1);
            }
        }

        const newsService = new NewsService();

        // ===== UI MANAGER =====
        class UIManager {
            constructor() {
                this.currentFilter = 'all';
                this.currentView = 'latest';
                this.intervalIds = [];
            }

            showNotification(message, type = 'info') {
                const existing = document.querySelector('.notification');
                if (existing) existing.remove();
                
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.setAttribute('role', 'alert');
                notification.setAttribute('aria-live', 'polite');
                
                const icons = {
                    success: 'check-circle',
                    error: 'alert-circle',
                    warning: 'alert-triangle',
                    info: 'info',
                    breaking: 'alert-octagon'
                };
                
                notification.innerHTML = `
                    <i data-lucide="${icons[type] || 'info'}" aria-hidden="true"></i>
                    <span>${message}</span>
                `;
                
                const bgColor = type === 'breaking' ? 'rgba(255, 71, 87, 0.1)' : 
                               type === 'error' ? 'rgba(255, 71, 87, 0.1)' : 
                               type === 'success' ? 'rgba(0, 255, 157, 0.1)' : 
                               'rgba(0, 149, 255, 0.1)';
                
                const borderColor = type === 'breaking' ? '#ff4757' : 
                                   type === 'error' ? '#ff4757' : 
                                   type === 'success' ? '#00ff9d' : '#0095ff';
                
                Object.assign(notification.style, {
                    background: bgColor,
                    borderColor: borderColor,
                    color: type === 'breaking' ? '#ff6b81' : 
                           type === 'error' ? '#ff6b81' : 
                           type === 'success' ? '#00ff9d' : '#0095ff'
                });
                
                document.body.appendChild(notification);
                lucide.createIcons();
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, type === 'breaking' ? 8000 : 5000);
            }

            renderArticles(articles) {
                const container = document.getElementById('articlesContainer');
                if (!container) return;
                
                let articlesToShow = [...articles];
                
                // Apply filter
                if (this.currentFilter !== 'all') {
                    if (this.currentFilter === 'breaking') {
                        articlesToShow = articlesToShow.filter(article => article.isBreaking);
                    } else {
                        articlesToShow = articlesToShow.filter(article => 
                            article.tags.includes(this.currentFilter)
                        );
                    }
                }
                
                // Apply view sort
                if (this.currentView === 'top') {
                    articlesToShow.sort((a, b) => b.impactScore - a.impactScore);
                } else if (this.currentView === 'trending') {
                    articlesToShow.sort((a, b) => {
                        const aTrending = a.tags.some(tag => appState.get('trendingTopics').has(tag));
                        const bTrending = b.tags.some(tag => appState.get('trendingTopics').has(tag));
                        if (aTrending && !bTrending) return -1;
                        if (!aTrending && bTrending) return 1;
                        return b.impactScore - a.impactScore;
                    });
                }
                
                if (articlesToShow.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i data-lucide="newspaper" style="width: 48px; height: 48px;" aria-hidden="true"></i>
                            <h3>No articles found</h3>
                            <p>Try a different filter or refresh the feed</p>
                        </div>
                    `;
                    lucide.createIcons();
                    return;
                }
                
                const articlesHTML = articlesToShow.slice(0, CONSTANTS.UI.MAX_VISIBLE_ARTICLES).map(article => `
                    <article class="news-card ${article.isBreaking ? 'breaking' : ''}" data-id="${article.id}" aria-labelledby="title-${article.id}">
                        <div class="card-header">
                            <div class="card-source">
                                <div class="source-icon ${article.sourceIcon}" aria-hidden="true">
                                    ${newsService.getSourceAbbreviation(article.source)}
                                </div>
                                <span>${article.source}</span>
                                <span aria-hidden="true">•</span>
                                <span>${article.time}</span>
                            </div>
                            <div class="card-time">
                                <i data-lucide="clock" aria-hidden="true"></i> ${article.readTime}
                            </div>
                        </div>
                        
                        <h3 class="card-title" id="title-${article.id}">
                            ${article.isBreaking ? '🚨 ' : ''}${article.title}
                        </h3>
                        
                        <p class="card-summary">${article.summary}</p>
                        
                        <div class="card-tags">
                            ${article.tags.map(tag => `
                                <div class="tag ${tag} ${article.isBreaking && tag === 'breaking' ? 'breaking' : ''}">
                                    ${newsService.getTagDisplayName(tag)}
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="card-footer">
                            <div class="impact-score">
                                <span class="impact-label">Impact Score:</span>
                                <span class="impact-value ${article.impactClass}">${article.impactScore.toFixed(1)}</span>
                            </div>
                            <div class="card-actions">
                                <button class="action-btn" 
                                        aria-label="${storage.isSaved(article.id) ? 'Remove from saved' : 'Save article'}"
                                        title="${storage.isSaved(article.id) ? 'Remove from saved' : 'Save article'}"
                                        onclick="app.toggleSave(${article.id}, this)"
                                        onkeydown="if(event.key === 'Enter' || event.key === ' ') app.toggleSave(${article.id}, this)">
                                    <i data-lucide="${storage.isSaved(article.id) ? 'bookmark-check' : 'bookmark'}" aria-hidden="true"></i>
                                </button>
                                <button class="action-btn" 
                                        aria-label="Share article"
                                        title="Share article"
                                        onclick="app.shareArticle(${article.id})"
                                        onkeydown="if(event.key === 'Enter' || event.key === ' ') app.shareArticle(${article.id})">
                                    <i data-lucide="share-2" aria-hidden="true"></i>
                                </button>
                                <button class="action-btn" 
                                        aria-label="Read full article"
                                        title="Read full article"
                                        onclick="window.open('${article.url}', '_blank')"
                                        onkeydown="if(event.key === 'Enter' || event.key === ' ') window.open('${article.url}', '_blank')">
                                    <i data-lucide="external-link" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </article>
                `).join('');
                
                container.innerHTML = articlesHTML;
                lucide.createIcons();
            }

            renderSkeleton(count = 3) {
                const container = document.getElementById('articlesContainer');
                if (!container) return;
                
                const skeletonHTML = Array(count).fill(0).map(() => `
                    <div class="news-card skeleton-card">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                    </div>
                `).join('');
                
                container.innerHTML = skeletonHTML;
            }

            renderHeatmap() {
                const heatmapData = [
                    { label: 'Energy Prices (EU)', value: '€142.5/MWh', type: 'energy' },
                    { label: 'Data Center Vacancy (VA)', value: '2.1%', type: 'data' },
                    { label: 'Land Value (Dublin)', value: '+18.7%', type: 'realestate' },
                    { label: 'Carbon Intensity (SG)', value: '0.39 kg/kWh', type: 'energy' }
                ];
                
                const container = document.getElementById('heatmapContainer');
                if (!container) return;
                
                container.innerHTML = heatmapData.map(item => `
                    <div class="heatmap-item">
                        <div class="heatmap-label">
                            <div class="heatmap-dot ${item.type}" aria-hidden="true"></div>
                            <span>${item.label}</span>
                        </div>
                        <div class="heatmap-value" style="color: ${item.type === 'energy' ? '#00ff9d' : item.type === 'data' ? '#0095ff' : '#ffa500'}">
                            ${item.value}
                        </div>
                    </div>
                `).join('');
            }

            renderPolicy() {
                const policyData = [
                    { label: 'EU AI Act', value: 'Enacted', status: 'enacted' },
                    { label: 'US Data Privacy', value: 'In Committee', status: 'pending' },
                    { label: 'China Cloud Regs', value: 'Delayed', status: 'delayed' },
                    { label: 'SG Green DC Tax', value: 'Draft', status: 'draft' }
                ];
                
                const container = document.getElementById('policyTracker');
                if (!container) return;
                
                container.innerHTML = policyData.map(item => `
                    <div class="heatmap-item">
                        <div class="heatmap-label">
                            <i data-lucide="${this.getPolicyIcon(item.status)}" aria-hidden="true"></i>
                            <span>${item.label}</span>
                        </div>
                        <div class="heatmap-value" style="color: ${this.getPolicyColor(item.status)}">
                            ${item.value}
                        </div>
                    </div>
                `).join('');
                
                lucide.createIcons();
            }

            renderTrendingTopics(topics) {
                const container = document.getElementById('trendingTopics');
                if (!container) return;
                
                if (topics.size === 0) {
                    container.innerHTML = '<span style="color: var(--color-text-muted); font-size: 0.9rem;">No trending topics yet</span>';
                    return;
                }
                
                const topicsHTML = Array.from(topics).map(topic => `
                    <div class="trending-topic" 
                         onclick="app.filterByTopic('${topic}')"
                         onkeydown="if(event.key === 'Enter' || event.key === ' ') app.filterByTopic('${topic}')"
                         role="button"
                         tabindex="0">
                        #${newsService.getTagDisplayName(topic)}
                    </div>
                `).join('');
                
                container.innerHTML = topicsHTML;
            }

            renderTLDR(article) {
                const container = document.getElementById('tldrContainer');
                if (!container || !article) return;
                
                container.innerHTML = `
                    <div class="tldr-header">
                        <i data-lucide="zap" aria-hidden="true"></i>
                        <span>${article.title.substring(0, 40)}...</span>
                    </div>
                    <div class="tldr-content">
                        <div class="tldr-item">
                            <span class="tldr-bullet" aria-hidden="true">•</span>
                            <span>${article.summary.substring(0, 100)}</span>
                        </div>
                        <div class="tldr-item">
                            <span class="tldr-bullet" aria-hidden="true">•</span>
                            <span>Impact: ${article.impactScore.toFixed(1)}/10</span>
                        </div>
                        <div class="tldr-item">
                            <span class="tldr-bullet" aria-hidden="true">•</span>
                            <span>Source: ${article.source}</span>
                        </div>
                    </div>
                `;
                
                lucide.createIcons();
            }

            renderFeedHealth(articlesCount) {
                const container = document.getElementById('feedHealth');
                if (!container) return;
                
                const now = new Date();
                const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                container.innerHTML = `
                    <div class="heatmap-item">
                        <div class="heatmap-label">
                            <i data-lucide="wifi" style="color: #00ff9d" aria-hidden="true"></i>
                            <span>Feed Status</span>
                        </div>
                        <div class="heatmap-value" style="color: #00ff9d">Live</div>
                    </div>
                    <div class="heatmap-item">
                        <div class="heatmap-label">
                            <i data-lucide="database" style="color: #0095ff" aria-hidden="true"></i>
                            <span>Articles</span>
                        </div>
                        <div class="heatmap-value" style="color: #0095ff">${articlesCount}</div>
                    </div>
                    <div class="heatmap-item">
                        <div class="heatmap-label">
                            <i data-lucide="refresh-cw" style="color: #ffa500" aria-hidden="true"></i>
                            <span>Last Update</span>
                        </div>
                        <div class="heatmap-value" style="color: #ffa500">${timeStr}</div>
                    </div>
                `;
                
                lucide.createIcons();
            }

            updateFeedStats(articlesCount) {
                const lastUpdate = document.getElementById('lastUpdateTime');
                const articleCount = document.getElementById('articleCount');
                const liveStatus = document.getElementById('liveStatus');
                
                if (lastUpdate) {
                    const now = new Date();
                    lastUpdate.textContent = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                }
                
                if (articleCount) {
                    articleCount.textContent = `${articlesCount} articles`;
                }
                
                if (liveStatus) {
                    liveStatus.textContent = 'Live';
                }
            }

            showBreakingNews(breakingCount) {
                const banner = document.getElementById('breakingBanner');
                const breakingText = document.getElementById('breakingText');
                
                if (breakingCount > 0) {
                    banner.style.display = 'flex';
                    breakingText.textContent = `${breakingCount} Breaking News ${breakingCount > 1 ? 'Stories' : 'Story'}`;
                    this.showNotification('🚨 Breaking News Alert! Check the feed for updates.', 'breaking');
                } else {
                    banner.style.display = 'none';
                }
            }

            getPolicyIcon(status) {
                return {
                    enacted: 'file-check',
                    pending: 'clock',
                    delayed: 'alert-circle',
                    draft: 'file-text'
                }[status] || 'file-text';
            }

            getPolicyColor(status) {
                return {
                    enacted: '#00ff9d',
                    pending: '#ffa500',
                    delayed: '#ff4757',
                    draft: '#0095ff'
                }[status] || '#ffffff';
            }

            setupEventListeners() {
                // Filter chips
                document.querySelectorAll('.filter-chip').forEach(chip => {
                    chip.addEventListener('click', () => {
                        document.querySelectorAll('.filter-chip').forEach(c => {
                            c.classList.remove('active');
                            c.setAttribute('aria-pressed', 'false');
                        });
                        chip.classList.add('active');
                        chip.setAttribute('aria-pressed', 'true');
                        this.currentFilter = chip.dataset.filter || 'all';
                        this.renderArticles(appState.get('articles'));
                    });
                    
                    chip.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            chip.click();
                        }
                    });
                });
                
                // View options
                document.querySelectorAll('.view-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.view-btn').forEach(b => {
                            b.classList.remove('active');
                            b.setAttribute('aria-checked', 'false');
                        });
                        btn.classList.add('active');
                        btn.setAttribute('aria-checked', 'true');
                        this.currentView = btn.dataset.view || 'latest';
                        this.renderArticles(appState.get('articles'));
                    });
                });
                
                // Refresh button
                const refreshBtn = document.getElementById('refreshFeed');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => app.refreshFeed());
                }
                
                // Search button
                const searchBtn = document.getElementById('searchBtn');
                const searchModal = document.getElementById('searchModal');
                const closeSearch = document.getElementById('closeSearch');
                const searchInput = document.getElementById('searchInput');
                
                if (searchBtn) {
                    searchBtn.addEventListener('click', () => {
                        searchModal.classList.add('active');
                        searchInput.focus();
                    });
                }
                
                if (closeSearch) {
                    closeSearch.addEventListener('click', () => {
                        searchModal.classList.remove('active');
                    });
                }
                
                // Debounced search
                const debouncedSearch = debounce((query) => {
                    this.handleSearch(query);
                }, CONSTANTS.UI.SEARCH_DEBOUNCE);
                
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        debouncedSearch(e.target.value);
                    });
                }
                
                // Map points
                document.querySelectorAll('.map-point').forEach(point => {
                    point.addEventListener('click', () => {
                        const loc = point.classList[1];
                        const messages = {
                            virginia: "Virginia, USA: World's largest data center market",
                            dublin: "Dublin, Ireland: Fastest-growing hyperscale market in EU",
                            singapore: "Singapore: Asia-Pacific hub with green regulations",
                            tokyo: "Tokyo: High-density market with energy challenges"
                        };
                        this.showNotification(messages[loc] || 'Data center hotspot', 'info');
                    });
                });
                
                // Close modal on escape
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && searchModal.classList.contains('active')) {
                        searchModal.classList.remove('active');
                    }
                });
            }

            handleSearch(query) {
                if (!query.trim()) return;
                
                const articles = appState.get('articles');
                const filtered = articles.filter(article => 
                    article.title.toLowerCase().includes(query.toLowerCase()) ||
                    article.summary.toLowerCase().includes(query.toLowerCase()) ||
                    article.tags.some(tag => tag.includes(query.toLowerCase()))
                );
                
                const resultsContainer = document.getElementById('searchResults');
                if (!resultsContainer) return;
                
                if (filtered.length === 0) {
                    resultsContainer.innerHTML = `
                        <div class="empty-state">
                            <i data-lucide="search" style="width: 48px; height: 48px;" aria-hidden="true"></i>
                            <h3>No results for "${query}"</h3>
                            <p>Try a different search term</p>
                        </div>
                    `;
                    lucide.createIcons();
                } else {
                    const articlesHTML = filtered.map(article => `
                        <div class="news-card" style="margin-bottom: 1rem;">
                            <div class="card-header">
                                <div class="card-source">
                                    <div class="source-icon ${article.sourceIcon}">${newsService.getSourceAbbreviation(article.source)}</div>
                                    <span>${article.source}</span>
                                    <span>•</span>
                                    <span>${article.time}</span>
                                </div>
                            </div>
                            <h3 class="card-title">${article.title}</h3>
                            <p class="card-summary">${article.summary}</p>
                            <div class="card-tags">
                                ${article.tags.map(tag => `<div class="tag ${tag}">${newsService.getTagDisplayName(tag)}</div>`).join('')}
                            </div>
                        </div>
                    `).join('');
                    
                    resultsContainer.innerHTML = `
                        <h3 style="color: var(--color-electric-green); margin-bottom: 1rem;">
                            Search Results for "${query}" (${filtered.length} found)
                        </h3>
                        ${articlesHTML}
                    `;
                    lucide.createIcons();
                }
            }

            startLiveUpdates() {
                // Update articles every 5 minutes
                const updateInterval = setInterval(() => {
                    app.refreshFeed(false); // Silent refresh
                }, NEWS_CONFIG.UPDATE_INTERVAL);
                
                // Check for breaking news every minute
                const breakingInterval = setInterval(() => {
                    const breakingCount = appState.get('articles').filter(a => a.isBreaking).length;
                    this.showBreakingNews(breakingCount);
                }, NEWS_CONFIG.BREAKING_CHECK_INTERVAL);
                
                this.intervalIds.push(updateInterval, breakingInterval);
            }

            cleanup() {
                this.intervalIds.forEach(id => clearInterval(id));
                this.intervalIds = [];
            }
        }

        const ui = new UIManager();

        // ===== APPLICATION CONTROLLER =====
        class Application {
            constructor() {
                this.newsService = newsService;
                this.ui = ui;
                this.state = appState;
                this.storage = storage;
            }

            async init() {
                try {
                    // Initialize storage
                    await this.storage.initialize();
                    
                    // Show loading state
                    this.ui.renderSkeleton();
                    
                    // Load initial data
                    await this.loadNews();
                    
                    // Render UI components
                    this.ui.renderHeatmap();
                    this.ui.renderPolicy();
                    this.ui.renderFeedHealth(this.state.get('articles').length);
                    this.ui.updateFeedStats(this.state.get('articles').length);
                    
                    // Setup event listeners
                    this.ui.setupEventListeners();
                    
                    // Start live updates
                    this.ui.startLiveUpdates();
                    
                    // Show welcome notification
                    this.ui.showNotification('🔄 Connected to live news feed. Updates every 5 minutes.', 'success');
                    
                } catch (error) {
                    console.error('Initialization error:', error);
                    this.ui.showNotification('⚠️ Using enhanced sample data with real-time simulation.', 'warning');
                    this.loadSampleData();
                }
            }

            async loadNews() {
                try {
                    this.state.set('ui.loading', true);
                    
                    // Fetch articles
                    const rawArticles = await this.newsService.fetchArticles();
                    const processedArticles = this.newsService.processArticles(rawArticles);
                    
                    // Update state
                    this.state.set('articles', processedArticles);
                    
                    // Update trending topics
                    this.updateTrendingTopics(processedArticles);
                    
                    // Update breaking news
                    const breakingNews = processedArticles.filter(a => a.isBreaking);
                    this.state.set('breakingNews', breakingNews);
                    this.ui.showBreakingNews(breakingNews.length);
                    
                    // Update TL;DR
                    if (processedArticles.length > 0) {
                        this.ui.renderTLDR(processedArticles[0]);
                    }
                    
                    // Render articles
                    this.ui.renderArticles(processedArticles);
                    
                    // Update stats
                    this.ui.updateFeedStats(processedArticles.length);
                    
                    // Update trending topics display
                    this.ui.renderTrendingTopics(this.state.get('trendingTopics'));
                    
                } catch (error) {
                    console.error('Error loading news:', error);
                    this.ui.showNotification('❌ Failed to load news. Using sample data.', 'error');
                    this.loadSampleData();
                } finally {
                    this.state.set('ui.loading', false);
                }
            }

            async refreshFeed(showNotification = true) {
                const refreshBtn = document.getElementById('refreshFeed');
                const icon = refreshBtn?.querySelector('i');
                
                if (icon) {
                    icon.setAttribute('data-lucide', 'loader-2');
                    lucide.createIcons();
                }
                
                try {
                    await this.loadNews();
                    if (showNotification) {
                        this.ui.showNotification('✅ Feed refreshed successfully', 'success');
                    }
                } catch (error) {
                    console.error('Refresh error:', error);
                    this.ui.showNotification('❌ Failed to refresh feed', 'error');
                } finally {
                    if (icon) {
                        icon.setAttribute('data-lucide', 'refresh-cw');
                        lucide.createIcons();
                    }
                }
            }

            loadSampleData() {
                const sampleArticles = this.newsService.fetchSampleData();
                const processedArticles = this.newsService.processArticles(sampleArticles);
                
                this.state.set('articles', processedArticles);
                this.updateTrendingTopics(processedArticles);
                
                const breakingNews = processedArticles.filter(a => a.isBreaking);
                this.state.set('breakingNews', breakingNews);
                this.ui.showBreakingNews(breakingNews.length);
                
                if (processedArticles.length > 0) {
                    this.ui.renderTLDR(processedArticles[0]);
                }
                
                this.ui.renderArticles(processedArticles);
                this.ui.updateFeedStats(processedArticles.length);
                this.ui.renderTrendingTopics(this.state.get('trendingTopics'));
            }

            updateTrendingTopics(articles) {
                const tagCounts = {};
                articles.forEach(article => {
                    article.tags.forEach(tag => {
                        if (tag !== 'breaking' && tag !== 'general') {
                            tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                        }
                    });
                });
                
                const topTags = Object.entries(tagCounts)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5)
                    .map(([tag]) => tag);
                
                this.state.set('trendingTopics', new Set(topTags));
            }

            async toggleSave(articleId, button) {
                try {
                    const isSaved = this.storage.isSaved(articleId);
                    
                    if (isSaved) {
                        await this.storage.removeArticle(articleId);
                        if (button) {
                            const icon = button.querySelector('i');
                            icon.setAttribute('data-lucide', 'bookmark');
                            button.style.background = '';
                            button.style.color = '';
                            lucide.createIcons();
                        }
                        this.ui.showNotification('Article removed from saved', 'info');
                    } else {
                        await this.storage.saveArticle(articleId);
                        if (button) {
                            const icon = button.querySelector('i');
                            icon.setAttribute('data-lucide', 'bookmark-check');
                            button.style.background = '#00ff9d';
                            button.style.color = '#0a0a0f';
                            lucide.createIcons();
                        }
                        this.ui.showNotification('Article saved to bookmarks', 'success');
                    }
                } catch (error) {
                    console.error('Toggle save error:', error);
                    this.ui.showNotification('Failed to save article', 'error');
                }
            }

            async shareArticle(articleId) {
                try {
                    const article = this.state.get('articles').find(a => a.id === articleId);
                    if (!article) return;
                    
                    if (navigator.share) {
                        await navigator.share({
                            title: article.title,
                            text: article.summary,
                            url: article.url
                        });
                    } else {
                        await navigator.clipboard.writeText(`${article.title}\n\n${article.summary}\n\nRead more: ${article.url}`);
                        this.ui.showNotification('📋 Article copied to clipboard!', 'success');
                    }
                } catch (error) {
                    console.error('Share error:', error);
                    if (error.name !== 'AbortError') {
                        this.ui.showNotification('Failed to share article', 'error');
                    }
                }
            }

            filterByTopic(topic) {
                const chip = document.querySelector(`[data-filter="${topic}"]`);
                if (chip) {
                    chip.click();
                }
            }
        }

        // ===== INITIALIZE APPLICATION =====
        const app = new Application();

        // Make app methods globally available
        window.app = app;
        window.toggleSave = (id, btn) => app.toggleSave(id, btn);
        window.shareArticle = (id) => app.shareArticle(id);
        window.filterByTopic = (topic) => app.filterByTopic(topic);

        // Initialize on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => app.init());

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            ui.cleanup();
        });
    </script>
</body>
</html>