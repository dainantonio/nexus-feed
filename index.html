<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Nexus Feed | Live AI Ã— Data Ã— Energy Ã— Policy</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* ===== IMPROVED STYLES ===== */
        :root {
            --color-bg-dark: #0a0a0f;
            --color-bg-card: #111118;
            --color-bg-sidebar: #0d0d14;
            --color-electric-green: #00ff9d;
            --color-data-blue: #0095ff;
            --color-accent-purple: #8a2be2;
            --color-text-primary: #ffffff;
            --color-text-secondary: #a0a0b0;
            --color-text-muted: #6a6a7a;
            --color-border: #222230;
            --color-tag-energy: rgba(0, 255, 157, 0.1);
            --color-tag-ai: rgba(0, 149, 255, 0.1);
            --color-tag-policy: rgba(138, 43, 226, 0.1);
            --color-tag-realestate: rgba(255, 165, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--color-bg-dark);
            color: var(--color-text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== IMPROVED HEADER ===== */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            gap: 0;
        }

        .app-header {
            grid-column: 1 / -1;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--color-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--color-electric-green), var(--color-data-blue));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--color-text-primary), var(--color-electric-green));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--color-text-muted);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        /* ===== IMPROVED FILTER CHIPS ===== */
        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 1.5rem 2rem;
            grid-column: 1 / -1;
        }

        .filter-chip {
            padding: 0.5rem 1.25rem;
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-chip:hover {
            border-color: var(--color-electric-green);
            color: var(--color-text-primary);
            transform: translateY(-2px);
        }

        .filter-chip.active {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
            border-color: var(--color-electric-green);
            font-weight: 600;
        }

        /* ===== IMPROVED SIDEBAR ===== */
        .left-sidebar {
            grid-column: 1;
            background-color: var(--color-bg-sidebar);
            border-right: 1px solid var(--color-border);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .sidebar-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--color-text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ===== IMPROVED HEAT MAP ===== */
        .heatmap-container {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--color-border);
        }

        .heatmap-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .heatmap-item:last-child {
            border-bottom: none;
        }

        .heatmap-label {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .heatmap-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .heatmap-dot.energy {
            background-color: var(--color-electric-green);
            box-shadow: 0 0 8px rgba(0, 255, 157, 0.5);
        }

        .heatmap-dot.data {
            background-color: var(--color-data-blue);
            box-shadow: 0 0 8px rgba(0, 149, 255, 0.5);
        }

        .heatmap-dot.realestate {
            background-color: #ffa500;
            box-shadow: 0 0 8px rgba(255, 165, 0, 0.5);
        }

        .heatmap-value {
            font-weight: 600;
        }

        /* ===== IMPROVED MAIN FEED ===== */
        .main-feed {
            grid-column: 2;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .feed-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .feed-stats {
            display: flex;
            gap: 15px;
            align-items: center;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .view-options {
            display: flex;
            gap: 10px;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            background-color: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: 6px;
            font-size: 0.85rem;
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .view-btn.active {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
            border-color: var(--color-electric-green);
        }

        /* ===== IMPROVED NEWS CARDS ===== */
        .news-card {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--color-border);
            transition: var(--transition);
            position: relative;
        }

        .news-card:hover {
            border-color: var(--color-electric-green);
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 255, 157, 0.1);
        }

        .news-card.breaking {
            border-left: 4px solid #ff4757;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { border-left-color: #ff4757; }
            50% { border-left-color: #ff6b81; }
            100% { border-left-color: #ff4757; }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .card-source {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--color-text-secondary);
        }

        .source-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.7rem;
        }

        .source-icon.mit {
            background-color: #8b0000;
            color: white;
        }

        .source-icon.reuters {
            background-color: #ff8000;
            color: white;
        }

        .source-icon.dcf {
            background-color: #0066cc;
            color: white;
        }

        .source-icon.techcrunch {
            background-color: #00a562;
            color: white;
        }

        .source-icon.ft {
            background-color: #fff1e5;
            color: #333;
        }

        .source-icon.wsj {
            background-color: #0074c1;
            color: white;
        }

        .source-icon.nyt {
            background-color: #333;
            color: white;
        }

        .source-icon.bloomberg {
            background-color: #000;
            color: white;
        }

        .source-icon.cnn {
            background-color: #cc0000;
            color: white;
        }

        .source-icon.bbc {
            background-color: #bb1919;
            color: white;
        }

        .source-icon.theverge {
            background-color: #ff4400;
            color: white;
        }

        .source-icon.wired {
            background-color: #000;
            color: white;
        }

        .card-time {
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .card-summary {
            color: var(--color-text-secondary);
            margin-bottom: 1.25rem;
            line-height: 1.6;
        }

        .card-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
        }

        .tag {
            padding: 0.35rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .tag.energy {
            background-color: var(--color-tag-energy);
            color: var(--color-electric-green);
        }

        .tag.ai {
            background-color: var(--color-tag-ai);
            color: var(--color-data-blue);
        }

        .tag.policy {
            background-color: var(--color-tag-policy);
            color: #c792ea;
        }

        .tag.realestate {
            background-color: var(--color-tag-realestate);
            color: #ffa500;
        }

        .tag.cooling {
            background-color: rgba(0, 191, 255, 0.1);
            color: #00bfff;
        }

        .tag.security {
            background-color: rgba(255, 65, 108, 0.1);
            color: #ff416c;
        }

        .tag.breaking {
            background-color: rgba(255, 71, 87, 0.1);
            color: #ff4757;
            animation: pulse 2s infinite;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .impact-score {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .impact-label {
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }

        .impact-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .impact-value.high {
            color: var(--color-electric-green);
        }

        .impact-value.medium {
            color: #ffa500;
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            color: var(--color-text-secondary);
        }

        .action-btn:hover {
            background-color: var(--color-electric-green);
            color: var(--color-bg-dark);
        }

        /* ===== IMPROVED RIGHT SIDEBAR ===== */
        .right-sidebar {
            grid-column: 3;
            background-color: var(--color-bg-sidebar);
            border-left: 1px solid var(--color-border);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .resource-map {
            height: 300px;
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--color-border);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .map-container {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .map-point {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--color-electric-green);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.8);
            cursor: pointer;
        }

        .map-point.virginia {
            top: 40%;
            left: 25%;
        }

        .map-point.dublin {
            top: 30%;
            left: 45%;
        }

        .map-point.singapore {
            top: 60%;
            left: 75%;
        }

        .map-point.tokyo {
            top: 40%;
            left: 85%;
        }

        .map-label {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .map-point:hover .map-label {
            opacity: 1;
        }

        /* ===== IMPROVED TLDR SECTION ===== */
        .tldr-container {
            background-color: var(--color-bg-card);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            border: 1px solid var(--color-border);
            margin-bottom: 1.5rem;
        }

        .tldr-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 1rem;
            color: var(--color-electric-green);
        }

        .tldr-content {
            font-size: 0.9rem;
            color: var(--color-text-secondary);
        }

        .tldr-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 0.75rem;
        }

        .tldr-item:last-child {
            margin-bottom: 0;
        }

        .tldr-bullet {
            color: var(--color-electric-green);
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* ===== IMPROVED FOOTER ===== */
        .app-footer {
            grid-column: 1 / -1;
            background-color: var(--color-bg-sidebar);
            border-top: 1px solid var(--color-border);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--color-text-muted);
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-link {
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: var(--color-electric-green);
        }

        /* ===== NEW: TRENDING TOPICS ===== */
        .trending-topics {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .trending-topic {
            padding: 0.5rem 0.75rem;
            background-color: rgba(0, 149, 255, 0.1);
            border: 1px solid rgba(0, 149, 255, 0.3);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--color-data-blue);
            cursor: pointer;
            transition: var(--transition);
        }

        .trending-topic:hover {
            background-color: rgba(0, 149, 255, 0.2);
            transform: translateY(-2px);
        }

        /* ===== NEW: BREAKING NEWS BANNER ===== */
        .breaking-banner {
            background: linear-gradient(90deg, #ff4757, #ff6b81);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: pulse 2s infinite;
        }

        /* ===== NEW: LOADING STATES ===== */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            text-align: center;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--color-border);
            border-top-color: var(--color-electric-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--color-text-muted);
        }

        .skeleton {
            background: linear-gradient(90deg, #111118 25%, #1a1a24 50%, #111118 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ===== IMPROVED RESPONSIVE ===== */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 240px 1fr 280px;
            }
        }

        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto auto;
            }

            .left-sidebar, .right-sidebar {
                grid-column: 1;
                border: none;
                border-bottom: 1px solid var(--color-border);
            }

            .main-feed {
                grid-column: 1;
            }
        }

        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .filter-container {
                margin: 1rem;
            }

            .feed-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .feed-stats {
                justify-content: space-between;
                width: 100%;
            }

            .view-options {
                align-self: flex-end;
            }

            .card-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }

            .card-footer {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .card-actions {
                align-self: flex-end;
            }
        }

        /* ===== NEW: NOTIFICATION STYLES ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--color-bg-card);
            color: var(--color-electric-green);
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid var(--color-electric-green);
            z-index: 9999;
            box-shadow: 0 4px 20px rgba(0, 255, 157, 0.2);
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-container">
                <div class="logo-icon">
                    <i data-lucide="cpu" style="color: #0a0a0f;"></i>
                </div>
                <div class="logo-text">
                    <h1>The Nexus Feed</h1>
                    <p>Live AI Ã— Data Ã— Energy Ã— Policy</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="action-btn" title="Refresh Feed" id="refreshFeed">
                    <i data-lucide="refresh-cw"></i>
                </button>
                <button class="action-btn" title="Search" id="searchBtn">
                    <i data-lucide="search"></i>
                </button>
                <button class="action-btn" title="Settings" id="settingsBtn">
                    <i data-lucide="settings"></i>
                </button>
            </div>
        </header>

        <!-- Filter Chips -->
        <div class="filter-container">
            <div class="filter-chip active" data-filter="all">
                <i data-lucide="zap"></i> All Nexus
            </div>
            <div class="filter-chip" data-filter="ai">
                <i data-lucide="cpu"></i> AI & Compute
            </div>
            <div class="filter-chip" data-filter="energy">
                <i data-lucide="battery-charging"></i> Energy
            </div>
            <div class="filter-chip" data-filter="realestate">
                <i data-lucide="building-2"></i> Real Estate & Zoning
            </div>
            <div class="filter-chip" data-filter="policy">
                <i data-lucide="scale"></i> Policy & Regulation
            </div>
            <div class="filter-chip" data-filter="breaking">
                <i data-lucide="alert-circle"></i> Breaking News
            </div>
        </div>

        <!-- Left Sidebar -->
        <aside class="left-sidebar">
            <div class="sidebar-section">
                <h3><i data-lucide="trending-up"></i> Live Heat Maps</h3>
                <div class="heatmap-container" id="heatmapContainer"></div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="file-text"></i> Policy Tracker</h3>
                <div class="heatmap-container" id="policyTracker"></div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="trending-up"></i> Trending Topics</h3>
                <div class="trending-topics" id="trendingTopics">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </aside>

        <!-- Main Feed -->
        <main class="main-feed">
            <div class="feed-header">
                <div>
                    <h2>Today's Intelligence Feed</h2>
                    <div class="feed-stats">
                        <div class="stat-item">
                            <i data-lucide="clock"></i>
                            <span id="lastUpdateTime">Just now</span>
                        </div>
                        <div class="stat-item">
                            <i data-lucide="newspaper"></i>
                            <span id="articleCount">0 articles</span>
                        </div>
                        <div class="stat-item">
                            <i data-lucide="zap"></i>
                            <span id="liveStatus">Live</span>
                        </div>
                    </div>
                </div>
                <div class="view-options">
                    <button class="view-btn active" data-view="latest">Latest</button>
                    <button class="view-btn" data-view="top">Top Impact</button>
                    <button class="view-btn" data-view="trending">Trending</button>
                </div>
            </div>

            <!-- Breaking News Banner (Conditional) -->
            <div id="breakingBanner" class="breaking-banner" style="display: none;">
                <i data-lucide="alert-circle"></i>
                <span id="breakingText">Breaking News</span>
            </div>

            <!-- Articles Container -->
            <div id="articlesContainer">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Loading live news feed...</p>
                </div>
            </div>
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <div class="sidebar-section">
                <h3><i data-lucide="map-pin"></i> Data Center Map</h3>
                <div class="resource-map">
                    <div class="map-container">
                        <div class="map-point virginia"><div class="map-label">Virginia, USA</div></div>
                        <div class="map-point dublin"><div class="map-label">Dublin, Ireland</div></div>
                        <div class="map-point singapore"><div class="map-label">Singapore</div></div>
                        <div class="map-point tokyo"><div class="map-label">Tokyo, Japan</div></div>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="sparkles"></i> TL;DR Mode</h3>
                <div class="tldr-container" id="tldrContainer"></div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="activity"></i> Feed Health</h3>
                <div class="heatmap-container" id="feedHealth"></div>
            </div>
        </aside>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-copyright">
                Â© 2024 The Nexus Feed. Real-time intelligence for AI, Data, Energy, and Policy.
            </div>
            <div class="footer-links">
                <a href="#" class="footer-link">About</a>
                <a href="#" class="footer-link">API</a>
                <a href="#" class="footer-link">Sources</a>
                <a href="#" class="footer-link">Privacy</a>
                <a href="#" class="footer-link">Contact</a>
            </div>
        </footer>
    </div>

    <script>
        // ============================================
        // ENHANCED NEWS FEED WITH MULTIPLE SOURCES
        // ============================================

        // Initialize icons
        lucide.createIcons();

        // API Configuration
        const NEWS_CONFIG = {
            // Multiple news sources for redundancy
            SOURCES: [
                {
                    name: "NewsAPI",
                    url: "https://newsapi.org/v2/everything",
                    apiKey: "YOUR_NEWSAPI_KEY", // Get from https://newsapi.org
                    params: {
                        q: "(AI OR artificial intelligence) AND (data center OR energy OR policy)",
                        language: "en",
                        sortBy: "publishedAt",
                        pageSize: 10
                    }
                },
                {
                    name: "GNews",
                    url: "https://gnews.io/api/v4/search",
                    apiKey: "YOUR_GNEWS_KEY", // Get from https://gnews.io
                    params: {
                        q: "technology AI data center energy policy",
                        lang: "en",
                        max: 10
                    }
                }
            ],
            
            // RSS Feeds as backup
            RSS_FEEDS: [
                "https://techcrunch.com/feed/",
                "https://www.wired.com/feed/rss",
                "https://feeds.arstechnica.com/arstechnica/index",
                "https://www.theverge.com/rss/index.xml",
                "https://www.zdnet.com/news/rss.xml"
            ],
            
            // Update intervals
            UPDATE_INTERVAL: 300000, // 5 minutes
            BREAKING_CHECK_INTERVAL: 60000, // 1 minute
            
            // Keywords for categorization
            KEYWORDS: {
                ai: ["AI", "artificial intelligence", "machine learning", "deep learning", "neural network", "GPT", "OpenAI"],
                energy: ["energy", "power", "electricity", "solar", "wind", "nuclear", "renewable", "carbon"],
                policy: ["policy", "regulation", "law", "legislation", "government", "EU", "US", "China"],
                realestate: ["real estate", "zoning", "land", "property", "construction", "development"],
                cooling: ["cooling", "immersion", "liquid", "thermal", "heat", "PUE"],
                security: ["security", "cybersecurity", "privacy", "encryption", "attack", "breach"]
            }
        };

        // State Management
        let currentFilter = "all";
        let currentView = "latest";
        let savedArticles = JSON.parse(localStorage.getItem('nexusSaved')) || [];
        let liveArticles = [];
        let breakingNews = [];
        let trendingTopics = new Set();
        
        // Initialize
        async function init() {
            try {
                // Load initial data
                await loadNews();
                renderHeatmap();
                renderPolicy();
                renderTLDR();
                renderFeedHealth();
                updateFeedStats();
                
                // Setup event listeners
                setupEventListeners();
                
                // Start background updates
                startLiveUpdates();
                
                // Show welcome
                showNotification("ðŸ”„ Connected to live news feed. Updates every 5 minutes.", "success");
                
            } catch (error) {
                console.error("Initialization error:", error);
                // Fallback to sample data
                loadSampleData();
                showNotification("âš ï¸ Using sample data. Add API keys for live news.", "warning");
            }
        }

        // Enhanced News Loading
        async function loadNews() {
            try {
                showLoadingState();
                
                // Try multiple sources
                const articles = await Promise.any([
                    fetchFromNewsAPI(),
                    fetchFromRSSFeeds(),
                    fetchSampleData() // Fallback
                ]);
                
                // Process and enrich articles
                liveArticles = await processArticles(articles);
                
                // Detect breaking news
                detectBreakingNews();
                
                // Update trending topics
                updateTrendingTopics();
                
                // Render everything
                renderArticles();
                updateFeedStats();
                
            } catch (error) {
                console.error("Error loading news:", error);
                throw error;
            }
        }

        // Fetch from NewsAPI
        async function fetchFromNewsAPI() {
            // Mock implementation - replace with actual API calls
            return fetchSampleData();
            
            /* REAL IMPLEMENTATION (uncomment and add your API key):
            const source = NEWS_CONFIG.SOURCES[0];
            const params = new URLSearchParams({
                ...source.params,
                apiKey: source.apiKey
            });
            
            const response = await fetch(`${source.url}?${params}`);
            if (!response.ok) throw new Error(`NewsAPI error: ${response.status}`);
            
            const data = await response.json();
            return data.articles.map(article => ({
                title: article.title,
                summary: article.description,
                source: article.source.name,
                url: article.url,
                publishedAt: article.publishedAt,
                content: article.content
            }));
            */
        }

        // Fetch from RSS Feeds
        async function fetchFromRSSFeeds() {
            // Use a CORS proxy for RSS feeds
            const feedUrl = NEWS_CONFIG.RSS_FEEDS[0];
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(feedUrl)}`;
            
            try {
                const response = await fetch(proxyUrl);
                const data = await response.json();
                
                // Parse RSS XML (simplified)
                const parser = new DOMParser();
                const xml = parser.parseFromString(data.contents, "text/xml");
                const items = xml.querySelectorAll('item');
                
                return Array.from(items).map(item => ({
                    title: item.querySelector('title')?.textContent || '',
                    summary: item.querySelector('description')?.textContent || '',
                    source: "RSS Feed",
                    url: item.querySelector('link')?.textContent || '#',
                    publishedAt: item.querySelector('pubDate')?.textContent || new Date().toISOString()
                }));
            } catch (error) {
                console.error("RSS fetch error:", error);
                return [];
            }
        }

        // Process and enrich articles
        async function processArticles(articles) {
            return articles.map((article, index) => {
                // Extract tags based on keywords
                const tags = extractTags(article.title + ' ' + article.summary);
                
                // Calculate impact score
                const impactScore = calculateImpactScore(article, tags);
                
                // Format time
                const time = formatTime(article.publishedAt || new Date());
                
                return {
                    id: index + 1,
                    title: article.title || "Untitled Article",
                    summary: article.summary || "No summary available.",
                    source: article.source || "Unknown Source",
                    sourceIcon: getSourceIcon(article.source),
                    time: time,
                    readTime: estimateReadTime(article.content || article.summary),
                    tags: tags,
                    impactScore: impactScore,
                    impactClass: impactScore >= 8 ? "high" : impactScore >= 6 ? "medium" : "low",
                    url: article.url || "#",
                    publishedAt: article.publishedAt || new Date().toISOString(),
                    isBreaking: false
                };
            });
        }

        // Extract tags from content
        function extractTags(content) {
            const tags = [];
            const contentLower = content.toLowerCase();
            
            for (const [tag, keywords] of Object.entries(NEWS_CONFIG.KEYWORDS)) {
                if (keywords.some(keyword => contentLower.includes(keyword.toLowerCase()))) {
                    tags.push(tag);
                }
            }
            
            return tags.length > 0 ? tags : ["general"];
        }

        // Calculate impact score
        function calculateImpactScore(article, tags) {
            let score = 5; // Base score
            
            // Source credibility
            const credibleSources = ["Reuters", "Bloomberg", "Financial Times", "Wall Street Journal", "MIT"];
            if (credibleSources.some(src => article.source?.includes(src))) score += 2;
            
            // Number of tags
            score += Math.min(tags.length, 3);
            
            // Title length (longer titles often more detailed)
            if (article.title?.length > 100) score += 1;
            
            // Recentness
            const hoursAgo = (new Date() - new Date(article.publishedAt)) / (1000 * 60 * 60);
            if (hoursAgo < 1) score += 2; // Less than 1 hour
            else if (hoursAgo < 24) score += 1; // Less than 24 hours
            
            return Math.min(10, Math.max(1, score)).toFixed(1);
        }

        // Detect breaking news
        function detectBreakingNews() {
            breakingNews = liveArticles.filter(article => {
                const title = article.title.toLowerCase();
                const breakingKeywords = [
                    "breaking", "urgent", "alert", "crisis", "emergency",
                    "outage", "attack", "hack", "leak", "scandal"
                ];
                
                return breakingKeywords.some(keyword => title.includes(keyword)) ||
                       article.impactScore >= 9;
            });
            
            if (breakingNews.length > 0) {
                showBreakingNews();
            }
        }

        // Update trending topics
        function updateTrendingTopics() {
            trendingTopics.clear();
            
            // Count tag occurrences
            const tagCounts = {};
            liveArticles.forEach(article => {
                article.tags.forEach(tag => {
                    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                });
            });
            
            // Get top 5 tags
            const topTags = Object.entries(tagCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5)
                .map(([tag]) => tag);
            
            trendingTopics = new Set(topTags);
            renderTrendingTopics();
        }

        // Show breaking news
        function showBreakingNews() {
            const banner = document.getElementById('breakingBanner');
            const breakingText = document.getElementById('breakingText');
            
            if (breakingNews.length > 0) {
                banner.style.display = 'flex';
                breakingText.textContent = `${breakingNews.length} Breaking News ${breakingNews.length > 1 ? 'Stories' : 'Story'}`;
                
                // Show notification
                showNotification("ðŸš¨ Breaking News Alert!", "breaking");
            }
        }

        // Render articles
        function renderArticles() {
            const container = document.getElementById('articlesContainer');
            if (!container) return;
            
            let articlesToShow = [...liveArticles];
            
            // Apply filters
            if (currentFilter !== "all") {
                if (currentFilter === "breaking") {
                    articlesToShow = breakingNews;
                } else {
                    articlesToShow = articlesToShow.filter(article => 
                        article.tags.includes(currentFilter)
                    );
                }
            }
            
            // Apply view sorting
            if (currentView === "top") {
                articlesToShow.sort((a, b) => b.impactScore - a.impactScore);
            } else if (currentView === "trending") {
                articlesToShow.sort((a, b) => {
                    const aTrending = a.tags.some(tag => trendingTopics.has(tag));
                    const bTrending = b.tags.some(tag => trendingTopics.has(tag));
                    if (aTrending && !bTrending) return -1;
                    if (!aTrending && bTrending) return 1;
                    return b.impactScore - a.impactScore;
                });
            }
            
            if (articlesToShow.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i data-lucide="newspaper" style="width: 48px; height: 48px;"></i>
                        <h3>No articles found</h3>
                        <p>Try a different filter or refresh the feed</p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }
            
            // Generate articles HTML
            const articlesHTML = articlesToShow.map(article => `
                <article class="news-card ${article.isBreaking ? 'breaking' : ''}" data-id="${article.id}">
                    <div class="card-header">
                        <div class="card-source">
                            <div class="source-icon ${article.sourceIcon}">
                                ${getSourceAbbreviation(article.source)}
                            </div>
                            <span>${article.source}</span>
                            <span>â€¢</span>
                            <span>${article.time}</span>
                        </div>
                        <div class="card-time">
                            <i data-lucide="clock"></i> ${article.readTime}
                        </div>
                    </div>
                    
                    <h3 class="card-title">
                        ${article.isBreaking ? 'ðŸš¨ ' : ''}${article.title}
                    </h3>
                    
                    <p class="card-summary">${article.summary}</p>
                    
                    <div class="card-tags">
                        ${article.tags.map(tag => `
                            <div class="tag ${tag} ${article.isBreaking && tag === 'breaking' ? 'breaking' : ''}">
                                ${getTagDisplayName(tag)}
                            </div>
                        `).join('')}
                        ${article.isBreaking ? '<div class="tag breaking">Breaking</div>' : ''}
                    </div>
                    
                    <div class="card-footer">
                        <div class="impact-score">
                            <span class="impact-label">Impact Score:</span>
                            <span class="impact-value ${article.impactClass}">${article.impactScore}</span>
                        </div>
                        <div class="card-actions">
                            <button class="action-btn" title="Save" onclick="toggleSave(${article.id}, this)">
                                <i data-lucide="${savedArticles.includes(article.id) ? 'bookmark-check' : 'bookmark'}"></i>
                            </button>
                            <button class="action-btn" title="Share" onclick="shareArticle(${article.id})">
                                <i data-lucide="share-2"></i>
                            </button>
                            <button class="action-btn" title="Read" onclick="window.open('${article.url}', '_blank')">
                                <i data-lucide="external-link"></i>
                            </button>
                        </div>
                    </div>
                </article>
            `).join('');
            
            container.innerHTML = articlesHTML;
            lucide.createIcons();
        }

        // Render trending topics
        function renderTrendingTopics() {
            const container = document.getElementById('trendingTopics');
            if (!container) return;
            
            if (trendingTopics.size === 0) {
                container.innerHTML = '<span style="color: var(--color-text-muted); font-size: 0.9rem;">No trending topics yet</span>';
                return;
            }
            
            const topicsHTML = Array.from(trendingTopics).map(topic => `
                <div class="trending-topic" onclick="filterByTopic('${topic}')">
                    #${getTagDisplayName(topic)}
                </div>
            `).join('');
            
            container.innerHTML = topicsHTML;
        }

        // Update feed statistics
        function updateFeedStats() {
            const lastUpdate = document.getElementById('lastUpdateTime');
            const articleCount = document.getElementById('articleCount');
            const liveStatus = document.getElementById('liveStatus');
            
            if (lastUpdate) {
                lastUpdate.textContent = "Just now";
            }
            
            if (articleCount) {
                articleCount.textContent = `${liveArticles.length} articles`;
            }
            
            if (liveStatus) {
                liveStatus.textContent = "Live";
            }
        }

        // Show loading state
        function showLoadingState() {
            const container = document.getElementById('articlesContainer');
            if (!container) return;
            
            container.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Fetching latest news from multiple sources...</p>
                </div>
            `;
        }

        // Start live updates
        function startLiveUpdates() {
            // Update news every 5 minutes
            setInterval(async () => {
                try {
                    await loadNews();
                    showNotification("ðŸ“° Feed updated with latest news", "success");
                } catch (error) {
                    console.error("Auto-update error:", error);
                }
            }, NEWS_CONFIG.UPDATE_INTERVAL);
            
            // Check for breaking news every minute
            setInterval(() => {
                detectBreakingNews();
            }, NEWS_CONFIG.BREAKING_CHECK_INTERVAL);
            
            // Update timestamps every minute
            setInterval(updateTimeStamps, 60000);
        }

        // Update timestamps
        function updateTimeStamps() {
            const now = new Date();
            const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            const feedTime = document.querySelector('#feedHealth .heatmap-item:nth-child(3) .heatmap-value');
            if (feedTime) feedTime.textContent = timeStr;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Filter chips
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter || "all";
                    renderArticles();
                });
            });
            
            // View buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentView = this.dataset.view || "latest";
                    renderArticles();
                });
            });
            
            // Refresh button
            const refreshBtn = document.getElementById('refreshFeed');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', async () => {
                    const icon = refreshBtn.querySelector('i');
                    icon.setAttribute('data-lucide', 'loader-2');
                    lucide.createIcons();
                    
                    try {
                        await loadNews();
                        showNotification("âœ… Feed refreshed successfully", "success");
                    } catch (error) {
                        showNotification("âŒ Failed to refresh feed", "error");
                    } finally {
                        icon.setAttribute('data-lucide', 'refresh-cw');
                        lucide.createIcons();
                    }
                });
            }
            
            // Search button
            const searchBtn = document.getElementById('searchBtn');
            if (searchBtn) {
                searchBtn.addEventListener('click', () => {
                    const query = prompt("Search articles:");
                    if (query) {
                        filterBySearch(query);
                    }
                });
            }
            
            // Map points
            document.querySelectorAll('.map-point').forEach(point => {
                point.addEventListener('click', function() {
                    const loc = this.classList[1];
                    const messages = {
                        virginia: "Virginia, USA: World's largest data center market",
                        dublin: "Dublin, Ireland: Fastest-growing hyperscale market in EU",
                        singapore: "Singapore: Asia-Pacific hub with green regulations",
                        tokyo: "Tokyo: High-density market with energy challenges"
                    };
                    showNotification(messages[loc] || "Data center hotspot");
                });
            });
        }

        // ===== HELPER FUNCTIONS =====
        
        // Sample data for fallback
        function fetchSampleData() {
            return Promise.resolve([
                {
                    title: "Microsoft's Nuclear-Powered AI Data Centers Set New Industry Standard",
                    summary: "Microsoft partners with nuclear energy providers to power next-gen AI data centers, addressing both energy demands and sustainability goals.",
                    source: "MIT Technology Review",
                    url: "https://www.technologyreview.com/2024/01/16/1086795/microsoft-nuclear-powered-data-center-ai/",
                    publishedAt: new Date().toISOString(),
                    content: "Full article content would go here..."
                },
                {
                    title: "Google Achieves Record 1.02 PUE with Immersion Cooling in Singapore",
                    summary: "Google's immersion cooling trial shows significant energy savings, potentially revolutionizing data center cooling technology.",
                    source: "Data Center Frontier",
                    url: "https://www.datacenterfrontier.com/energy/article/33029472/google-immersion-cooling-singapore-pue-102",
                    publishedAt: new Date(Date.now() - 3600000).toISOString(),
                    content: "Full article content would go here..."
                },
                {
                    title: "EU Proposes Strict Data Center Zoning Laws Near Residential Areas",
                    summary: "New European legislation could restrict data center construction, impacting hyperscaler expansion plans across the continent.",
                    source: "Reuters",
                    url: "https://www.reuters.com/technology/eu-proposes-data-center-zoning-laws-near-residential-areas-2024-01-16/",
                    publishedAt: new Date(Date.now() - 7200000).toISOString(),
                    content: "Full article content would go here..."
                },
                {
                    title: "AI Compute Demand Outstrips Renewable Energy Growth, Study Finds",
                    summary: "New research shows AI development is growing faster than renewable energy capacity, raising sustainability concerns.",
                    source: "Bloomberg",
                    url: "https://www.bloomberg.com/news/articles/2024-01-16/ai-compute-demand-outstrips-renewable-energy-growth",
                    publishedAt: new Date(Date.now() - 10800000).toISOString(),
                    content: "Full article content would go here..."
                },
                {
                    title: "Amazon's Texas Data Center Expansion Faces Water Scarcity Challenges",
                    summary: "Local regulators question water usage as Amazon plans major data center expansion in drought-prone Texas regions.",
                    source: "TechCrunch",
                    url: "https://techcrunch.com/2024/01/15/amazon-texas-data-center-water-scarcity/",
                    publishedAt: new Date(Date.now() - 14400000).toISOString(),
                    content: "Full article content would go here..."
                }
            ]);
        }

        function loadSampleData() {
            liveArticles = [
                {
                    id: 1,
                    title: "Microsoft's Nuclear-Powered AI Data Centers Set New Industry Standard",
                    summary: "Microsoft partners with nuclear energy providers to power next-gen AI data centers, addressing both energy demands and sustainability goals.",
                    source: "MIT Technology Review",
                    sourceIcon: "mit",
                    time: "Just now",
                    readTime: "5 min read",
                    tags: ["energy", "ai", "policy"],
                    impactScore: 9.2,
                    impactClass: "high",
                    url: "https://www.technologyreview.com/2024/01/16/1086795/microsoft-nuclear-powered-data-center-ai/"
                },
                {
                    id: 2,
                    title: "Google Achieves Record 1.02 PUE with Immersion Cooling in Singapore",
                    summary: "Google's immersion cooling trial shows significant energy savings, potentially revolutionizing data center cooling technology.",
                    source: "Data Center Frontier",
                    sourceIcon: "dcf",
                    time: "1 hour ago",
                    readTime: "4 min read",
                    tags: ["energy", "cooling", "ai"],
                    impactScore: 8.8,
                    impactClass: "high",
                    url: "https://www.datacenterfrontier.com/energy/article/33029472/google-immersion-cooling-singapore-pue-102"
                },
                {
                    id: 3,
                    title: "EU Proposes Strict Data Center Zoning Laws Near Residential Areas",
                    summary: "New European legislation could restrict data center construction, impacting hyperscaler expansion plans across the continent.",
                    source: "Reuters",
                    sourceIcon: "reuters",
                    time: "2 hours ago",
                    readTime: "6 min read",
                    tags: ["policy", "realestate"],
                    impactScore: 7.5,
                    impactClass: "medium",
                    url: "https://www.reuters.com/technology/eu-proposes-data-center-zoning-laws-near-residential-areas-2024-01-16/"
                },
                {
                    id: 4,
                    title: "AI Compute Demand Outstrips Renewable Energy Growth, Study Finds",
                    summary: "New research shows AI development is growing faster than renewable energy capacity, raising sustainability concerns.",
                    source: "Bloomberg",
                    sourceIcon: "bloomberg",
                    time: "3 hours ago",
                    readTime: "7 min read",
                    tags: ["ai", "energy", "policy"],
                    impactScore: 8.1,
                    impactClass: "high",
                    url: "https://www.bloomberg.com/news/articles/2024-01-16/ai-compute-demand-outstrips-renewable-energy-growth"
                },
                {
                    id: 5,
                    title: "BREAKING: Major Data Center Outage Affects Multiple Cloud Providers",
                    summary: "A widespread outage in Virginia data centers impacts AWS, Azure, and Google Cloud services across North America.",
                    source: "CNBC",
                    sourceIcon: "cnn",
                    time: "10 minutes ago",
                    readTime: "3 min read",
                    tags: ["breaking", "security", "energy"],
                    impactScore: 9.5,
                    impactClass: "high",
                    url: "#",
                    isBreaking: true
                }
            ];
            
            detectBreakingNews();
            updateTrendingTopics();
            renderArticles();
            updateFeedStats();
        }

        // Helper functions
        function getSourceIcon(source) {
            const sourceMap = {
                "MIT": "mit",
                "Reuters": "reuters",
                "Bloomberg": "bloomberg",
                "TechCrunch": "techcrunch",
                "Financial Times": "ft",
                "Wall Street Journal": "wsj",
                "New York Times": "nyt",
                "Data Center Frontier": "dcf",
                "CNBC": "cnn",
                "BBC": "bbc",
                "The Verge": "theverge",
                "Wired": "wired"
            };
            
            for (const [key, icon] of Object.entries(sourceMap)) {
                if (source.includes(key)) return icon;
            }
            
            return "mit"; // Default icon
        }

        function getSourceAbbreviation(source) {
            if (!source) return "??";
            const words = source.split(' ');
            if (words.length >= 2) {
                return (words[0][0] + words[1][0]).toUpperCase();
            }
            return source.substring(0, 2).toUpperCase();
        }

        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return "Just now";
            if (diffMins < 60) return `${diffMins} min ago`;
            if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
            if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
            
            return date.toLocaleDateString();
        }

        function estimateReadTime(content) {
            if (!content) return "3 min";
            const words = content.split(/\s+/).length;
            const minutes = Math.ceil(words / 200);
            return `${minutes} min`;
        }

        function getTagDisplayName(tag) {
            const tagNames = {
                'energy': 'Energy',
                'ai': 'AI',
                'policy': 'Policy',
                'realestate': 'Real Estate',
                'cooling': 'Cooling',
                'security': 'Security',
                'breaking': 'Breaking',
                'general': 'General'
            };
            return tagNames[tag] || tag.charAt(0).toUpperCase() + tag.slice(1);
        }

        // Global functions
        window.toggleSave = function(articleId, button) {
            const index = savedArticles.indexOf(articleId);
            const icon = button.querySelector('i');
            
            if (index === -1) {
                savedArticles.push(articleId);
                icon.setAttribute('data-lucide', 'bookmark-check');
                button.style.background = '#00ff9d';
                button.style.color = '#0a0a0f';
                showNotification("Article saved to bookmarks", "success");
            } else {
                savedArticles.splice(index, 1);
                icon.setAttribute('data-lucide', 'bookmark');
                button.style.background = '';
                button.style.color = '';
                showNotification("Article removed from bookmarks", "info");
            }
            
            lucide.createIcons();
            localStorage.setItem('nexusSaved', JSON.stringify(savedArticles));
        };

        window.shareArticle = function(articleId) {
            const article = liveArticles.find(a => a.id === articleId);
            if (!article) return;
            
            if (navigator.share) {
                navigator.share({
                    title: article.title,
                    text: article.summary,
                    url: article.url
                });
            } else {
                navigator.clipboard.writeText(`${article.title}\n\n${article.summary}\n\nRead more: ${article.url}`);
                showNotification("ðŸ“‹ Article copied to clipboard!", "success");
            }
        };

        window.filterByTopic = function(topic) {
            const chip = document.querySelector(`[data-filter="${topic}"]`);
            if (chip) {
                chip.click();
            }
        };

        function filterBySearch(query) {
            const filtered = liveArticles.filter(article => 
                article.title.toLowerCase().includes(query.toLowerCase()) ||
                article.summary.toLowerCase().includes(query.toLowerCase()) ||
                article.tags.some(tag => tag.includes(query.toLowerCase()))
            );
            
            const container = document.getElementById('articlesContainer');
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i data-lucide="search" style="width: 48px; height: 48px;"></i>
                        <h3>No results for "${query}"</h3>
                        <p>Try a different search term</p>
                    </div>
                `;
                lucide.createIcons();
            } else {
                // Temporarily show filtered results
                const articlesHTML = filtered.map(article => `
                    <article class="news-card" data-id="${article.id}">
                        <div class="card-header">
                            <div class="card-source">
                                <div class="source-icon ${article.sourceIcon}">${getSourceAbbreviation(article.source)}</div>
                                <span>${article.source}</span>
                                <span>â€¢</span>
                                <span>${article.time}</span>
                            </div>
                        </div>
                        <h3 class="card-title">${article.title}</h3>
                        <p class="card-summary">${article.summary}</p>
                        <div class="card-tags">
                            ${article.tags.map(tag => `<div class="tag ${tag}">${getTagDisplayName(tag)}</div>`).join('')}
                        </div>
                    </article>
                `).join('');
                
                container.innerHTML = `
                    <div style="margin-bottom: 1.5rem;">
                        <h3 style="color: var(--color-electric-green);">Search Results for "${query}" (${filtered.length} found)</h3>
                        <button onclick="renderArticles()" style="background: none; border: 1px solid var(--color-border); color: var(--color-text-secondary); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;">
                            <i data-lucide="arrow-left" style="width: 16px; height: 16px;"></i> Back to all articles
                        </button>
                    </div>
                    ${articlesHTML}
                `;
                lucide.createIcons();
            }
        }

        // Render heatmap (same as before)
        function renderHeatmap() {
            const heatmapData = [
                { label: "Energy Prices (EU)", value: "â‚¬142.5/MWh", type: "energy" },
                { label: "Data Center Vacancy (VA)", value: "2.1%", type: "data" },
                { label: "Land Value (Dublin)", value: "+18.7%", type: "realestate" },
                { label: "Carbon Intensity (SG)", value: "0.39 kg/kWh", type: "energy" }
            ];
            
            const container = document.getElementById('heatmapContainer');
            if (!container) return;
            
            container.innerHTML = heatmapData.map(item => `
                <div class="heatmap-item">
                    <div class="heatmap-label">
                        <div class="heatmap-dot ${item.type}"></div>
                        <span>${item.label}</span>
                    </div>
                    <div class="heatmap-value" style="color: ${item.type === 'energy' ? '#00ff9d' : item.type === 'data' ? '#0095ff' : '#ffa500'}">
                        ${item.value}
                    </div>
                </div>
            `).join('');
        }

        // Render policy tracker
        function renderPolicy() {
            const policyData = [
                { label: "EU AI Act", value: "Enacted", status: "enacted" },
                { label: "US Data Privacy", value: "In Committee", status: "pending" },
                { label: "China Cloud Regs", value: "Delayed", status: "delayed" },
                { label: "SG Green DC Tax", value: "Draft", status: "draft" }
            ];
            
            const container = document.getElementById('policyTracker');
            if (!container) return;
            
            container.innerHTML = policyData.map(item => `
                <div class="heatmap-item">
                    <div class="heatmap-label">
                        <i data-lucide="${getPolicyIcon(item.status)}" style="color: ${getPolicyColor(item.status)}"></i>
                        <span>${item.label}</span>
                    </div>
                    <div class="heatmap-value" style="color: ${getPolicyColor(item.status)}">
                        ${item.value}
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        // Render TLDR
        function renderTLDR() {
            const container = document.getElementById('tldrContainer');
            if (!container || liveArticles.length === 0) return;
            
            const article = liveArticles[0];
            container.innerHTML = `
                <div class="tldr-header">
                    <i data-lucide="zap"></i>
                    <span>${article.title.substring(0, 40)}...</span>
                </div>
                <div class="tldr-content">
                    <div class="tldr-item">
                        <span class="tldr-bullet">â€¢</span>
                        <span>${article.summary.substring(0, 100)}</span>
                    </div>
                    <div class="tldr-item">
                        <span class="tldr-bullet">â€¢</span>
                        <span>Impact: ${article.impactScore}/10</span>
                    </div>
                    <div class="tldr-item">
                        <span class="tldr-bullet">â€¢</span>
                        <span>Source: ${article.source}</span>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
        }

        // Render feed health
        function renderFeedHealth() {
            const container = document.getElementById('feedHealth');
            if (!container) return;
            
            const now = new Date();
            const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            container.innerHTML = `
                <div class="heatmap-item">
                    <div class="heatmap-label">
                        <i data-lucide="wifi" style="color: #00ff9d"></i>
                        <span>Feed Status</span>
                    </div>
                    <div class="heatmap-value" style="color: #00ff9d">Live</div>
                </div>
                <div class="heatmap-item">
                    <div class="heatmap-label">
                        <i data-lucide="database" style="color: #0095ff"></i>
                        <span>Articles</span>
                    </div>
                    <div class="heatmap-value" style="color: #0095ff">${liveArticles.length}</div>
                </div>
                <div class="heatmap-item">
                    <div class="heatmap-label">
                        <i data-lucide="refresh-cw" style="color: #ffa500"></i>
                        <span>Last Update</span>
                    </div>
                    <div class="heatmap-value" style="color: #ffa500">${timeStr}</div>
                </div>
            `;
            
            lucide.createIcons();
        }

        function getPolicyIcon(status) {
            return {
                enacted: "file-check",
                pending: "clock",
                delayed: "alert-circle",
                draft: "file-text"
            }[status] || "file-text";
        }

        function getPolicyColor(status) {
            return {
                enacted: "#00ff9d",
                pending: "#ffa500",
                delayed: "#ff4757",
                draft: "#0095ff"
            }[status] || "#ffffff";
        }

        // Show notification
        function showNotification(message, type = "info") {
            // Remove existing notification
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            const icons = {
                success: "check-circle",
                error: "alert-circle",
                warning: "alert-triangle",
                info: "info",
                breaking: "alert-octagon"
            };
            
            notification.innerHTML = `
                <i data-lucide="${icons[type] || 'info'}" style="width: 16px; height: 16px; color: ${
                    type === 'success' ? '#00ff9d' : 
                    type === 'error' ? '#ff4757' : 
                    type === 'breaking' ? '#ff4757' : '#0095ff'
                }"></i>
                <span>${message}</span>
            `;
            
            // Style based on type
            const bgColor = type === 'breaking' ? 'rgba(255, 71, 87, 0.1)' : 
                           type === 'error' ? 'rgba(255, 71, 87, 0.1)' : 
                           type === 'success' ? 'rgba(0, 255, 157, 0.1)' : 
                           'rgba(0, 149, 255, 0.1)';
            
            const borderColor = type === 'breaking' ? '#ff4757' : 
                               type === 'error' ? '#ff4757' : 
                               type === 'success' ? '#00ff9d' : '#0095ff';
            
            Object.assign(notification.style, {
                background: bgColor,
                borderColor: borderColor,
                color: type === 'breaking' ? '#ff6b81' : 
                       type === 'error' ? '#ff6b81' : 
                       type === 'success' ? '#00ff9d' : '#0095ff'
            });
            
            document.body.appendChild(notification);
            lucide.createIcons();
            
            // Auto-remove after 5 seconds (longer for breaking news)
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, type === 'breaking' ? 8000 : 5000);
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>